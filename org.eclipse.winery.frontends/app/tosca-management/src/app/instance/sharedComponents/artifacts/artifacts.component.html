<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  ~ Copyright (c) 2020 Contributors to the Eclipse Foundation
  ~
  ~ See the NOTICE file(s) distributed with this work for additional
  ~ information regarding copyright ownership.
  ~
  ~ This program and the accompanying materials are made available under the
  ~ terms of the Eclipse Public License 2.0 which is available at
  ~ http://www.eclipse.org/legal/epl-2.0, or the Apache Software License 2.0
  ~ which is available at https://www.apache.org/licenses/LICENSE-2.0.
  ~
  ~ SPDX-License-Identifier: EPL-2.0 OR Apache-2.0
  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<div class="localLoader" [class.hidden]="!loading">
    <winery-loader></winery-loader>
</div>
<div>
    <winery-table
        [columns]="columns"
        [data]="artifactsTableDataList"
        (addBtnClicked)="onAddClick()"
        (removeBtnClicked)="onRemoveClick($event)">
    </winery-table>

    <winery-modal bsModal #addModal="bs-modal" [modalRef]="addModal">
        <winery-modal-header [title]="'Add Artifact'"></winery-modal-header>
        <winery-modal-body>
            <form #addArtifactForm="ngForm" id="addArtifactForm">
                <div class="form-group">
                    <label class="control-label" for="name">Name</label>
                    <input #artifactName="ngModel"
                           id="name"
                           class="form-control"
                           type="text"
                           name="name"
                           required
                           [(ngModel)]="artifactToBeAdded.id">

                    <div class="form-group">
                        <winery-qname-selector
                            [width]="'none'"
                            [title]="'Artifact Type'"
                            [displayList]="artifactTypes"
                            [toscaType]=""
                            [selectedValue]="artifactToBeAdded.id"
                            [showOpenButton]="false"
                            (selectedValueChanged)="onSelectedArtifactTypeChanged($event.value)"
                        ></winery-qname-selector>
                    </div>

                    <div class="form-group" id="yamlArtifactFileDiv">
                        <label for="fileUploader">Select Artifact File (will be uploaded when clicking on "Add")</label>
                        <br>
                        <input type="file" #fileUploader id="fileUploader" name="fileUploader"
                               [accept]="selectedYamlArtifactAllowedTypes"
                               (change)="yamlArtifactFileSelected($event.target.files)"/>
                    </div>

                    <ng-template #artifactFileNameOnly>
                        <div class="form-group" id="yamlArtifactFileNameDiv">
                            <label for="fileUploader">Selected File</label>
                            <br>
                            <button type="button"
                                    class="btn btn-link btn-anchor"
                                    (click)="downloadYamlArtifactFile()">{{deploymentArtifactOrPolicyModalData.modalFileName}}</button>
                        </div>
                    </ng-template>

                    <label class="control-label" for="deplPath">Deployment Path</label>
                    <input #artifactDeplPath="ngModel"
                           id="deplPath"
                           class="form-control"
                           type="text"
                           name="name"
                           required
                           [(ngModel)]="artifactToBeAdded.targetLocation">
                </div>
            </form>
        </winery-modal-body>
        <winery-modal-footer [showDefaultButtons]="false">
            <button type="button" class="btn btn-default" data-dismiss="modal" (click)="addModal.hide()">Cancel</button>
            <button type="button" [disabled]="!addArtifactForm?.form.valid" class="btn btn-primary"
                    (click)="addArtifact()">Add
            </button>
        </winery-modal-footer>
    </winery-modal>
</div>
